mode: debug  # debug, devel or prod

# use 0.0.0.0 if you want to connect from another machine. Only
# affects development configuration.
dev_server_interface: 127.0.0.1
dev_server_port: 8050
dev_processes: 4

prefix: https://iridl.ldeo.columbia.edu
core_path: /fbfmaproom
admin_path: /fbfmaproom-admin
tile_path: /fbfmaproom-tiles
support_email: help@iri.columbia.edu
bypass_dlauth: true
loglevel: info
gantt_url: https://fist-fbf-gantt2.iri.columbia.edu/gantt?

dlauth_client:
    prefix: https://iridl.ldeo.columbia.edu
    core_path: /auth
    session_cookie_name: __dlauth_id
    application_ssid: SNIP

db:
    dbname: DesignEngine  # postgres database name
    host: pgdb12.iri.columbia.edu
    port: 5432
    user: dero  # user name
    password: SNIP

enso_ds: &enso_ds
    label: ENSO State
    units:
    path: enso.zarr
    var_names:
        time: T
        value: dominant_class
    range: [1, 3]
    colormap: []
    lower_is_worse: no
    format: enso

data_root: /data/aaron/fbf

custom_asset_path: /path/to/my/custom/icons/directory

countries:
    malawi:
        logo: Malawi_IRI_98x48.png
        resolution: [1, 1]
        center: [37.5, -13]
        zoom: 7
        rotation: 0
        marker: [34, -14]
        shapes:
            - name: National
              sql: select adm0_code as key, adm0_name as label, ST_AsBinary(the_geom) as the_geom
                  from iridb.g2015_2012_0 where adm0_name = 'Malawi'
              vuln_sql: select adm0_code as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Malawi' group by 1, 2

            - name: Regional
              sql: select (adm0_code, adm1_code) as key, adm1_name as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.g2015_2014_1
                  where adm0_name = 'Malawi'
              vuln_sql: select (adm0_code, adm1_code) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Malawi' group by 1, 2

            - name: District
              sql: select (adm0_code, adm1_code, adm2_code) as key, adm2_name as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.g2015_2014_2
                  where adm0_name = 'Malawi'
              vuln_sql: select (adm0_code, adm1_code, adm2_code) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Malawi' group by 1, 2
        datasets:
            defaults:
                predictors:
                    - pnep
                    - rain
                predictand: bad-years
            observations:
                rain:
                    label: Rain
                    description: CMAP average precipitation over the season
                    path: rain-malawi.zarr
                    var_names:
                        value: prcp_est
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                enso_state: *enso_ds
                bad-years:
                    label: Reported bad years
                    path: malawi/bad-years.zarr
                    var_names:
                        value: bad
                        time: T
                    colormap: precip
                    lower_is_worse: no
                    format: bad
                crop-forecast:
                    label: Crop forecast
                    path: malawi/maize-feb.zarr
                    var_names:
                      geom_key: geom_key
                      time: time
                      value: value
                    lower_is_worse: yes
                    format: number2
                    colormap: precip

            forecasts:
                pnep:
                    label: Forecast prob non-exc
                    description: IRI Flexible Seasonal Forecast probability of non-exceedance of the selected percentile
                    path: pnep-malawi.zarr
                    var_names:
                        value: prob
                        lat: Y
                        lon: X
                        issue: S
                        lead: L
                        pct: P
                    colormap: pne_25
                    is_poe: no
            vuln:
                colormap: vulnerability
                range: [0.0, 5.0]
        seasons:
            season1:
                label: DJF
                target_month: 0.5  # season center in months since Jan 1: 0.0 <= season < 12.0
                length: 3.0
                issue_months: [7, 8, 9, 10]  # months since Jan 1: 0.0 <= season < 12.0
                start_year: 1983

    madagascar:
        logo: Madagascar_IRI_98x48.png
        resolution: [.0375, .0375]
        center: [49, -23]
        zoom: 7
        rotation: 0
        marker: [45.5, -24]
        clip: no
        shapes:
            - name: National
              sql: select adm0_code as key, adm0_name as label, ST_AsBinary(ST_Union(the_geom)) as the_geom
                  from iridb.g2015_2014_1 g where adm0_name = 'Madagascar'
                  and adm1_name in ('Androy', 'Anosy', 'Atsimo Andrefana', 'Atsimo Atsinanana')
                  group by 1, 2
              vuln_sql: select adm0_code as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Madagascar' group by 1, 2

            - name: Regional
              sql: select (adm0_code, adm1_code) as key, adm1_name as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.g2015_2014_1
                  where adm0_name = 'Madagascar'
                  and adm1_name in ('Androy', 'Anosy', 'Atsimo Andrefana', 'Atsimo Atsinanana')
              vuln_sql: select (adm0_code, adm1_code) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Madagascar' group by 1, 2

            - name: District
              sql: select (adm0_code, adm1_code, adm2_code) as key, adm2_name as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.g2015_2014_2
                  where adm0_name = 'Madagascar'
                  and adm1_name in ('Androy', 'Anosy', 'Atsimo Andrefana', 'Atsimo Atsinanana')
              vuln_sql: select (adm0_code, adm1_code, adm2_code) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Madagascar' group by 1, 2

        datasets:
            defaults:
                predictors:
                    - pnep
                    - enacts-precip-mon
                predictand: bad-years-v3
            observations:
                enacts-precip-mon:
                    label: ENACTS MON precip
                    description: ENACTS monitoring average precipitation over the season
                    path: madagascar/enacts-precip-mon-djf.zarr
                    var_names:
                        value: rfe
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                enacts-precip-all:
                    label: ENACTS All precip
                    description: ENACTS average precipitation over the season
                    path: madagascar/enacts-precip-djf.zarr
                    var_names:
                        value: rfe
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                chirps-precip-djf:
                    label: CHIRPS Precip
                    description: CHIRPS average precipitation over the season
                    path: madagascar/chirps-precip-djf.zarr
                    var_names:
                        value: precipitation
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                ndvi:
                    label: NDVI
                    description: MODIS NDVI average over the season
                    path: madagascar/ndvi-djf.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                wrsi:
                    label: WRSI
                    path: madagascar/wrsi-djf.zarr
                    var_names:
                        value: do
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                spi:
                    label: ENACTS MON SPI
                    description: SPI calculated from ENACTS monitoring product
                    path: madagascar/enacts-mon-spi-djf.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                subseas-dry-tercile-snov-l22-djf:
                    label: November biweekly forecast, 3wk lead
                    description: Biweekly rainfall forecast issued in early November for the two week period starting two weeks after the issue date. Probability of the driest tercile.
                    path: madagascar/subseas-dry-tercile-snov-l22-djf.zarr
                    var_names:
                        value: prob
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: no
                obs-subseas-rainfall:
                    label: Observed subseasonal rainfall
                    description: Observed rainfall during subseasonal forecast target period (mm)
                    path: madagascar/obs-subseas-rainfall.zarr
                    var_names:
                        value: aprod
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                onset:
                    label: Onset
                    description: Onset of rainy season (day of year)
                    path: madagascar/onset.zarr
                    var_names:
                        value: onset
                        time: time
                    colormap: precip
                    lower_is_worse: no
                    format: number0
                lors:
                    label: Duration
                    description: Length of rainy season (days)
                    path: madagascar/onset.zarr
                    var_names:
                        value: LORS
                        time: time
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                enso_state: *enso_ds
                bad-years-v2:
                    label: Drought humanitarian ranking v2
                    description: Drought ranking of expert committee humanitarian data review (v2)
                    path: madagascar/bad-years-djf.zarr
                    var_names:
                        value: rank
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                bad-years-v3:
                    label: Drought humanitarian ranking v3
                    description: Drought ranking of expert committee humanitarian data review (v3)
                    path: madagascar/bad-years-v3-djf.zarr
                    var_names:
                        value: rank
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                    units: rank
            forecasts:
                pnep:
                    label: Forecast prob non-exc
                    description: NextGen forecast probability of non-exceedance of the selected percentile
                    path: madagascar/pnep-djf.zarr
                    var_names:
                        value: pne
                        lat: Y
                        lon: X
                        issue: S
                        lead: null  # dataset has forecasts for only one season; L is implicit.
                        pct: P
                    colormap: pne_25
                    is_poe: no
            vuln:
                colormap: vulnerability
                range: [0.0, 5.0]
        seasons:
            season1:
                label: DJF
                target_month: 0.5  # season center in months since Jan 1: 0.0 <= season < 12.0
                length: 3.0
                issue_months: [8, 9, 10]  # months since Jan 1: 0.0 <= season < 12.0
                start_year: 1992

    madagascar-ond:
        logo: Madagascar_IRI_98x48.png
        resolution: [.0375, .0375]
        center: [49, -23]
        zoom: 7
        rotation: 0
        marker: [45.5, -24]
        clip: no
        shapes:
            - name: National
              sql: select adm0_code as key, adm0_name as label, ST_AsBinary(ST_Union(the_geom)) as the_geom
                  from iridb.g2015_2014_1 g where adm0_name = 'Madagascar'
                  and adm1_name in ('Androy', 'Anosy', 'Atsimo Andrefana', 'Atsimo Atsinanana')
                  group by 1, 2
              vuln_sql: select adm0_code as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Madagascar' group by 1, 2

            - name: Regional
              sql: select (adm0_code, adm1_code) as key, adm1_name as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.g2015_2014_1
                  where adm0_name = 'Madagascar'
                  and adm1_name in ('Androy', 'Anosy', 'Atsimo Andrefana', 'Atsimo Atsinanana')
              vuln_sql: select (adm0_code, adm1_code) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Madagascar' group by 1, 2

            - name: District
              sql: select (adm0_code, adm1_code, adm2_code) as key, adm2_name as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.g2015_2014_2
                  where adm0_name = 'Madagascar'
                  and adm1_name in ('Androy', 'Anosy', 'Atsimo Andrefana', 'Atsimo Atsinanana')
              vuln_sql: select (adm0_code, adm1_code, adm2_code) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Madagascar' group by 1, 2

        datasets:
            defaults:
                predictors:
                    - pnep
                    - enacts-precip-mon
                predictand: bad-years
            observations:
                enacts-precip-mon:
                    label: ENACTS MON precip
                    description: ENACTS monitoring average precipitation over the season
                    path: madagascar/enacts-precip-mon-ond.zarr
                    var_names:
                        value: rfe
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                enacts-precip:
                    label: ENACTS ALL precip
                    description: ENACTS all stations average precipitation over the season
                    path: madagascar/enacts-precip-ond.zarr
                    var_names:
                        value: rfe
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                chirps-precip-ond:
                    label: CHIRPS Precip
                    description: CHIRPS average precipitation over the season
                    path: madagascar/chirps-precip-ond.zarr
                    var_names:
                        value: precipitation
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                ndvi:
                    label: NDVI
                    description: MODIS NDVI average over the season
                    path: madagascar/ndvi-ond.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                wrsi:
                    label: WRSI
                    path: madagascar/wrsi-ond.zarr
                    var_names:
                        value: do
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                spi:
                    label: ENACTS MON SPI
                    description: SPI calculated from ENACTS monitoring product
                    path: madagascar/enacts-mon-spi-ond.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                enso_state: *enso_ds
                bad-years:
                    label: Drought humanitarian ranking
                    description: Drought ranking of expert committee humanitarian data review
                    path: madagascar/bad-years-ond.zarr
                    var_names:
                        value: rank
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
            forecasts:
                pnep:
                    label: Forecast prob non-exc
                    description: NextGen forecast probability of non-exceedance of the selected percentile
                    path: madagascar/pnep-ond.zarr
                    var_names:
                        value: pne
                        lat: Y
                        lon: X
                        issue: S
                        lead: null  # dataset has forecasts for only one season; L is implicit.
                        pct: P
                    colormap: pne_25
                    is_poe: no
            vuln:
                colormap: vulnerability
                range: [0.0, 5.0]
        seasons:
            season1:
                label: OND
                target_month: 10.5  # season center in months since Jan 1: 0.0 <= season < 12.0
                length: 3.0
                issue_months: [6, 7, 8]  # months since Jan 1: 0.0 <= season < 12.0
                start_year: 1993

    ethiopia:
        logo: Ethiopia_IRI_98x48.png
        resolution: [.25, .25]
        center: [43.875, 6.875]
        zoom: 6
        rotation: 0
        marker:  [43.875, 6.875]
        origin: [.125, .125]
        onload_warning: &ethwarn >-
            The triggers shown in this map tool are based only on
            the historical rankings of the individual predictor datasets,
            and do not currently reflect the more sophisticated trigger
            rules used in the FbF project.
        shapes:
            - name: Regional
              sql: select (adm1_pcode) as key, adm1_en as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.somali_region
              vuln_sql: select (adm1_pcode) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability_ethiopia_somali group by 1, 2

            - name: Zonal
              sql: select (adm1_pcode, adm2_pcode) as key, adm2_en as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.somali_zone
              vuln_sql: select (adm1_pcode, adm2_pcode) as key, year, vulnerability as vuln
                  from public.fbf_vulnerability_ethiopia_somali

            - name: Woreda
              sql: select (adm1_pcode, adm2_pcode, adm3_pcode) as key, adm3_en as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.somali_woreda
              vuln_sql: select (g.adm1_pcode, g.adm2_pcode, g.adm3_pcode) as key, g.adm3_en as label,
                  v.year, v.vulnerability as vuln from iridb.somali_woreda as g join
                  public.fbf_vulnerability_ethiopia_somali as v on (g.adm1_pcode=v.adm1_pcode and
                  g.adm2_pcode=v.adm2_pcode)

        datasets:
            defaults:
                predictors:
                    - pnep
                    - rain
                predictand: bad-years
            observations:
                rain:
                    label: Rain
                    description: CHIRPS average precipitation over the season
                    path: ethiopia/rain-mam.zarr
                    var_names:
                        value: prcp
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                enso_state: *enso_ds
                ndvi:
                    label: NDVI
                    path: ethiopia/ndvi-mam.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                ndvi-nov:
                    label: NDVI November
                    description: Average NDVI for November 1-16
                    path: ethiopia/ndvi-nov-mam.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                ndvi-dec:
                    label: NDVI December
                    description: Average NDVI for December
                    path: ethiopia/ndvi-dec-mam.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                ndvi-jan:
                    label: NDVI January
                    description: Average NDVI for January
                    path: ethiopia/ndvi-jan-mam.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                ndvi-feb:
                    label: NDVI February
                    description: Average NDVI for February
                    path: ethiopia/ndvi-feb-mam.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                spi:
                    label: SPI
                    description: SPI calculated from CHIRPS
                    path: ethiopia/spi-mam.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                rain-prev-seas:
                    label: Rain prev OND
                    description: CHIRPS average precipitation over the previous OND season
                    path: ethiopia/rain-prev-seas-mam.zarr
                    var_names:
                        value: prcp
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                ndvi-prev-seas:
                    label: NDVI prev OND
                    description: Average NDVI over the previous OND season
                    path: ethiopia/ndvi-prev-seas-mam.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                spi-prev-seas:
                    label: SPI prev OND
                    description: SPI calculated from CHIRPS for previous OND season
                    path: ethiopia/spi-prev-seas-mam.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                bad-years:
                    label: Reported bad years
                    path: ethiopia/bad-years-mam.zarr
                    var_names:
                        value: bad
                        time: T
                    colormap: precip
                    lower_is_worse: no
                    format: bad
            forecasts:
                pnep:
                    label: Forecast prob non-exc
                    description: NextGen forecast probability of non-exceedance of selected percentile
                    path: ethiopia/pnep-mam.zarr
                    var_names:
                        value: pne
                        lat: Y
                        lon: X
                        issue: S
                        lead: null  # dataset has forecasts for only one season; L is implicit.
                        pct: P
                    colormap: pne_25
                    is_poe: no
            vuln:
                colormap: vulnerability
                range: [0.0, 5.0]
        seasons:
            season1:
                label: MAM
                target_month: 3.5
                length: 3.0
                issue_months: [11, 0, 1]
                start_year: 1983
    ethiopia-ond:
        logo: Ethiopia_IRI_98x48.png
        resolution: [.25, .25]
        center: [43.875, 6.875]
        zoom: 6
        rotation: 0
        marker:  [43.875, 6.875]
        origin: [.125, .125]
        onload_warning: *ethwarn
        shapes:
            - name: Regional
              sql: select (adm1_pcode) as key, adm1_en as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.somali_region
              vuln_sql: select (adm1_pcode) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability_ethiopia_somali group by 1, 2

            - name: Zonal
              sql: select (adm1_pcode, adm2_pcode) as key, adm2_en as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.somali_zone
              vuln_sql: select (adm1_pcode, adm2_pcode) as key, year, vulnerability as vuln
                  from public.fbf_vulnerability_ethiopia_somali

            - name: Woreda
              sql: select (adm1_pcode, adm2_pcode, adm3_pcode) as key, adm3_en as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.somali_woreda
              vuln_sql: select (g.adm1_pcode, g.adm2_pcode, g.adm3_pcode) as key, g.adm3_en as label,
                  v.year, v.vulnerability as vuln from iridb.somali_woreda as g join
                  public.fbf_vulnerability_ethiopia_somali as v on (g.adm1_pcode=v.adm1_pcode and
                  g.adm2_pcode=v.adm2_pcode)

        datasets:
            defaults:
                predictors:
                    - pnep
                    - rain
                predictand: bad-years
            observations:
                rain:
                    label: Rain
                    description: CHIRPS average precipitation
                    path: ethiopia/rain-ond.zarr
                    var_names:
                        value: prcp
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                ndvi:
                    label: NDVI
                    path: ethiopia/ndvi-ond.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                spi:
                    label: SPI
                    description: SPI calculated from CHIRPS
                    path: ethiopia/spi-ond.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                rain-prev-seas:
                    label: Rain prev MAM
                    description: CHIRPS average precipitation over the previous MAM season
                    path: ethiopia/rain-prev-seas-ond.zarr
                    var_names:
                        value: prcp
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                ndvi-prev-seas:
                    label: NDVI prev MAM
                    description: Average NDVI over the previous MAM season
                    path: ethiopia/ndvi-prev-seas-ond.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                ndvi-jun:
                    label: NDVI June
                    description: Average NDVI for June
                    path: ethiopia/ndvi-jun-ond.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                ndvi-jul:
                    label: NDVI July
                    description: Average NDVI for July
                    path: ethiopia/ndvi-jul-ond.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                ndvi-aug:
                    label: NDVI August
                    description: Average NDVI for August
                    path: ethiopia/ndvi-aug-ond.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                spi-prev-seas:
                    label: SPI prev MAM
                    description: SPI for previous MAM season, calculated from CHIRPS
                    path: ethiopia/spi-prev-seas-ond.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                enso_state: *enso_ds
                bad-years:
                    label: Reported bad years
                    path: ethiopia/bad-years-ond.zarr
                    var_names:
                        value: bad
                        time: T
                    colormap: precip
                    lower_is_worse: no
                    format: bad
            forecasts:
                pnep:
                    label: Forecast prob non-exc
                    description: NextGen forecast probability of non-exceedance of selected percentile
                    path: ethiopia/pnep-ond.zarr
                    var_names:
                        value: pne
                        lat: Y
                        lon: X
                        issue: S
                        lead: null  # dataset has forecasts for only one season; L is implicit.
                        pct: P
                    colormap: pne_25
                    is_poe: no
            vuln:
                colormap: vulnerability
                range: [0.0, 5.0]
        seasons:
            season2:
                label: OND
                target_month: 10.5
                length: 3.0
                issue_months: [8, 7, 6]
                start_year: 1982
    southern-oromia:
        logo: Ethiopia_IRI_98x48.png
        resolution: [.25, .25]
        center: [40.0, 5.7]
        zoom: 6
        rotation: 0
        marker:  [40.0, 5.7]
        origin: [.125, .125]
        onload_warning: *ethwarn
        shapes:
            - name: Project Region
              sql: select adm1_pcode as key, 'Southern Oromia' as label,
                  ST_AsBinary(ST_Union(the_geom)) as the_geom
                  from iridb.ethiopia_southern_oromia
                  group by 1, 2
              vuln_sql:
                  select cast(null as varchar) as key,
                  0 as year,
                  0 as vuln
                  where 1 = 2

            - name: Zonal
              sql: select adm2_pcode as key, adm2_en as label,
                  ST_AsBinary(ST_Union(the_geom)) as the_geom
                  from iridb.ethiopia_southern_oromia
                  group by 1, 2
              vuln_sql:
                  select cast(null as varchar) as key,
                  0 as year,
                  0 as vuln
                  where 1 = 2

            - name: Woreda
              sql: select adm3_pcode as key, adm3_en as label,
                  ST_AsBinary(the_geom) as the_geom
                  from iridb.ethiopia_southern_oromia
              vuln_sql:
                  select cast(null as varchar) as key,
                  0 as year,
                  0 as vuln
                  where 1 = 2
        datasets:
            defaults:
                predictors:
                    - pnep
                    - rain
                predictand: bad-years
            observations:
                rain:
                    label: Rain
                    description: CHIRPS average precipitation over the season
                    path: ethiopia/rain-mam.zarr
                    var_names:
                        value: prcp
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                enso_state: *enso_ds
                ndvi:
                    label: NDVI
                    path: ethiopia/ndvi-mam.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                ndvi-nov:
                    label: NDVI November
                    description: Average NDVI for November 1-16
                    path: ethiopia/ndvi-nov-mam.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                ndvi-dec:
                    label: NDVI December
                    description: Average NDVI for December
                    path: ethiopia/ndvi-dec-mam.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                ndvi-jan:
                    label: NDVI January
                    description: Average NDVI for January
                    path: ethiopia/ndvi-jan-mam.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                ndvi-feb:
                    label: NDVI February
                    description: Average NDVI for February
                    path: ethiopia/ndvi-feb-mam.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                spi:
                    label: SPI
                    description: SPI calculated from CHIRPS
                    path: ethiopia/spi-mam.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                rain-prev-seas:
                    label: Rain prev OND
                    description: CHIRPS average precipitation over the previous OND season
                    path: ethiopia/rain-prev-seas-mam.zarr
                    var_names:
                        value: prcp
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                ndvi-prev-seas:
                    label: NDVI prev OND
                    description: Average NDVI over the previous OND season
                    path: ethiopia/ndvi-prev-seas-mam.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                spi-prev-seas:
                    label: SPI prev OND
                    description: SPI calculated from CHIRPS for previous OND season
                    path: ethiopia/spi-prev-seas-mam.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                bad-years:
                    label: Reported bad years
                    path: ethiopia/southern-oromia-bad-years-mam.zarr
                    var_names:
                        value: bad
                        time: T
                    colormap: precip
                    lower_is_worse: no
                    format: bad
            forecasts:
                pnep:
                    label: Forecast prob non-exc
                    description: NextGen forecast probability of non-exceedance of selected percentile
                    path: ethiopia/pnep-mam.zarr
                    var_names:
                        value: pne
                        lat: Y
                        lon: X
                        issue: S
                        lead: null  # dataset has forecasts for only one season; L is implicit.
                        pct: P
                    colormap: pne_25
                    is_poe: no
            vuln:
                colormap: vulnerability
                range: [0.0, 5.0]
        seasons:
            season1:
                label: MAM
                target_month: 3.5
                length: 3.0
                issue_months: [11, 0, 1]
                start_year: 1983
    southern-oromia-ond:
        logo: Ethiopia_IRI_98x48.png
        resolution: [.25, .25]
        center: [40.0, 5.7]
        zoom: 6
        rotation: 0
        marker:  [40.0, 5.7]
        origin: [.125, .125]
        onload_warning: *ethwarn
        shapes:
            - name: Project Region
              sql: select id_1 as key, 'Southern Oromia' as label, ST_AsBinary(ST_Union(the_geom)) as the_geom
                  from iridb.eth_zones_dd
                  where name_2 in ('East Shewa', 'Arsi', 'West Arsi', 'West Haraghe', 'East Haraghe', 'Bale', 'East Bale', 'Guji', 'Borena')
                  group by 1, 2

            - name: Zonal
              sql: select id_2 as key, name_2 as label, ST_AsBinary(the_geom) as the_geom from iridb.eth_zones_dd
                  where name_2 in ('East Shewa', 'Arsi', 'West Arsi', 'West Haraghe', 'East Haraghe', 'Bale', 'East Bale', 'Guji', 'Borena')

            - name: Woreda
              sql: select id_3 as key, name_3 as label, ST_AsBinary(the_geom) as the_geom from iridb.eth_woredas_dd
                  where name_2 in ('East Shewa', 'Arsi', 'West Arsi', 'West Haraghe', 'East Haraghe', 'Bale', 'East Bale', 'Guji', 'Borena')
        datasets:
            defaults:
                predictors:
                    - pnep
                    - rain
                predictand: bad-years
            observations:
                rain:
                    label: Rain
                    description: CHIRPS average precipitation over the season
                    path: ethiopia/rain-ond.zarr
                    var_names:
                        value: prcp
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                ndvi:
                    label: NDVI
                    path: ethiopia/ndvi-ond.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                spi:
                    label: SPI
                    description: SPI calculated from CHIRPS
                    path: ethiopia/spi-ond.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                rain-prev-seas:
                    label: Rain prev MAM
                    description: CHIRPS average precipitation over the previous MAM season
                    path: ethiopia/rain-prev-seas-ond.zarr
                    var_names:
                        value: prcp
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                ndvi-prev-seas:
                    label: NDVI prev MAM
                    description: Average NDVI over the previous MAM season
                    path: ethiopia/ndvi-prev-seas-ond.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                ndvi-jun:
                    label: NDVI June
                    description: Average NDVI for June
                    path: ethiopia/ndvi-jun-ond.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                ndvi-jul:
                    label: NDVI July
                    description: Average NDVI for July
                    path: ethiopia/ndvi-jul-ond.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                ndvi-aug:
                    label: NDVI August
                    description: Average NDVI for August
                    path: ethiopia/ndvi-aug-ond.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                spi-prev-seas:
                    label: SPI prev MAM
                    description: SPI calculated from CHIRPS for previous MAM season
                    path: ethiopia/spi-prev-seas-ond.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                enso_state: *enso_ds
                bad-years:
                    label: Reported bad years
                    path: ethiopia/southern-oromia-bad-years-ond.zarr
                    var_names:
                        value: bad
                        time: T
                    colormap: precip
                    lower_is_worse: no
                    format: bad
            forecasts:
                pnep:
                    label: Forecast prob non-exc
                    description: NextGen forecast probability of non-exceedance of selected percentile
                    path: ethiopia/pnep-ond.zarr
                    var_names:
                        value: pne
                        lat: Y
                        lon: X
                        issue: S
                        lead: null  # dataset has forecasts for only one season; L is implicit.
                        pct: P
                    colormap: pne_25
                    is_poe: no
            vuln:
                colormap: vulnerability
                range: [0.0, 5.0]
        seasons:
            season1:
                label: OND
                target_month: 10.5
                length: 3.0
                issue_months: [6, 7, 8]
                start_year: 1983
    niger:
        logo: Niger_IRI_120x48.png
        resolution: [0.05, 0.05]
        center: [8.1, 17]
        zoom: 6
        rotation: 0
        marker: [8.025, 17.025]
        shapes:
            - name: National
              sql: select adm0_code as key, adm0_name as label, ST_AsBinary(the_geom) as the_geom
                  from iridb.g2015_2012_0 where adm0_name = 'Niger'
              vuln_sql: select adm0_code as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Niger' group by 1, 2

            - name: Regional
              sql: select (adm0_code, adm1_code) as key, adm1_name as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.g2015_2014_1
                  where adm0_name = 'Niger'
              vuln_sql: select (adm0_code, adm1_code) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Niger' group by 1, 2

            - name: Department
              sql: select (adm0_code, adm1_code, adm2_code) as key, adm2_name as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.g2015_2014_2
                  where adm0_name = 'Niger'
              vuln_sql: select (adm0_code, adm1_code, adm2_code) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Niger' group by 1, 2

            - name: Commune
              sql: select rowcacode3 as key, adm_03 as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.ner_adm03_feb2018
              vuln_sql: select null as key, 0 as year, 0 as vuln where 1 = 2
              # ^ placeholder sql until we have vulnerabilities for the Commune level.
              # note that the type of each column must be correct or the generated
              # query will fail (in this case vuln needs to be a number), even if
              # there are zero rows

        datasets:
            defaults:
              predictors:
                - pnep
                - enacts-mon-spi-jj
              predictand: bad-years-v2
            observations:
                subseas-dry-tercile-sjul-l15:
                    label: Jul biweekly forecast, 2wk lead
                    description: Biweekly rainfall forecast issued in early July for the following two weeks. Probability of the driest tercile.
                    path: niger/subseas-dry-tercile-sjul-l15.zarr
                    var_names:
                        value: prob
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: no
                obs-subseas-rainfall:
                    label: Observed subseasonal rainfall
                    description: Observed rainfall during subseasonal forecast target period (mm)
                    path: niger/obs-subseas-rainfall.zarr
                    var_names:
                        value: aprod
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                enacts-precip-jas:
                    label: ENACTS Precip JAS
                    description: ENACTS total precipitation for Jul-Sep
                    path: niger/enacts-precip-jas.zarr
                    var_names:
                        value: obs
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                chirps-precip-jun:
                    label: CHIRPS Precip Jun
                    description: CHIRPS total precipitation for Jun
                    path: niger/chirps-precip-jun.zarr
                    var_names:
                        value: precipitation
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                chirps-precip-jjaso:
                    label: CHIRPS Precip Jun-Oct
                    description: CHIRPS total precipitation for Jun-Oct
                    path: niger/chirps-precip-jjaso.zarr
                    var_names:
                        value: precipitation
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                chirps-precip-jas:
                    label: CHIRPS Precip JAS
                    description: CHIRPS total precipitation for Jul-Sep
                    path: niger/chirps-precip-jas.zarr
                    var_names:
                        value: precipitation
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                enacts-spi-jas:
                    label: ENACTS SPI JAS
                    description: Average SPI over the season, calculated from ENACTS
                    path: niger/enacts-spi-jas.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                enacts-spi-jj:
                    label: ENACTS SPI Jun-Jul
                    description: Average SPI in June-July, calculated from ENACTS
                    path: niger/enacts-spi-jj.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                enacts-mon-spi-jj:
                    label: ENACTS MON SPI Jun-Jul
                    description: Average SPI in June-July, calculated from ENACTS monitoring product
                    path: niger/enacts-mon-spi-jj.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                enacts-mon-spi-jas:
                    label: ENACTS MON SPI JAS
                    description: Average SPI in July-September, calculated from ENACTS monitoring product
                    path: niger/enacts-mon-spi-jas.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                enacts-mon-spi-jas-excess:
                    label: ENACTS MON SPI JAS Excess
                    description: Average SPI in July-September, calculated from ENACTS monitoring product, highlighting wettest years
                    path: niger/enacts-mon-spi-jas.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: no
                    format: number3
                chirp-spi-jj:
                    label: CHIRP SPI Jun-Jul
                    description: Average SPI in June-July, calculated from CHIRP
                    path: niger/chirp-spi-jj.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                chirp-spi-jas:
                    label: CHIRP SPI JAS
                    description: Average SPI in July-September, calculated from CHIRP
                    path: niger/chirp-spi-jas.zarr
                    var_names:
                        value: spi
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
                chirps-dryspell:
                    label: Dry Spell
                    description: Longest dry spell, calculated from CHIRPS
                    path: niger/chirps-dryspell.zarr
                    var_names:
                        value: lls
                        lat: Y
                        lon: X
                        time: T
                    units: days
                    colormap: precip
                    lower_is_worse: no
                    format: number2
                chirps-onset:
                    label: Onset
                    description: Onset of rain, calculated from CHIRPS
                    path: niger/chirps-onset.zarr
                    var_names:
                        value: adif
                        lat: Y
                        lon: X
                        time: T
                    units: days after May 1
                    colormap: precip
                    lower_is_worse: no
                    format: number2
                enso_state: *enso_ds
                bad-years:
                    label: Reported bad years v1
                    path: niger/bad-years.zarr
                    var_names:
                        value: bad
                        time: T
                    colormap: precip
                    lower_is_worse: no
                    format: bad
                bad-years-v2:
                    label: Reported bad years v2
                    path: niger/bad-years-v2.zarr
                    var_names:
                        value: rank
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                station-spi-jj:
                    label: Station SPI Jun-Jul
                    description: Average SPI in June-July, calculated from DMN weather station data.
                    path: niger/station-spi-jj.zarr
                    var_names:
                        value: Average
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number3
            forecasts:
                pnep:
                    label: JAS forecast prob non-exc
                    description: NextGen seasonal rainfall forecast probability of non-exceedance of the selected percentile for the July-September season
                    path: niger/pnep-jas-v3.zarr
                    var_names:
                        value: pne
                        lat: Y
                        lon: X
                        issue: S
                        lead: null  # dataset has forecasts for only one season; L is implicit.
                        pct: P
                    colormap: pne_25
                    is_poe: no
                pnep-jj:
                    label: JJ forecast prob non-exc
                    description: NextGen seasonal rainfall forecast probability of non-exceedance of the selected percentile for June-July
                    path: niger/pnep-jj.zarr
                    var_names:
                        value: pne
                        lat: Y
                        lon: X
                        issue: S
                        lead: null  # dataset has forecasts for only one season; L is implicit.
                        pct: P
                    colormap: pne_25
                    is_poe: no
                pnep-jjaso:
                    label: JJASO forecast prob non-exc
                    description: NextGen seasonal rainfall forecast probability of non-exceedance of the selected percentile for June-July-August-September-October
                    path: niger/pnep-jjaso.zarr
                    var_names:
                        value: pne
                        lat: Y
                        lon: X
                        issue: S
                        lead: null  # dataset has forecasts for only one season; L is implicit.
                        pct: P
                    colormap: pne_25
                    is_poe: no
                poe-onset:
                    label: Onset forecast prob exc
                    description: NextGen onset date forecast probability of exceedance of the selected percentile
                    path: niger/poe-onset.zarr
                    var_names:
                        value: poe
                        lat: Y
                        lon: X
                        issue: S
                        lead: null
                        pct: P
                    colormap: pne_25
                    is_poe: yes
                poe-dryspell:
                    label: Dry spell forecast prob exc
                    description: NextGen max dry spell length forecast probability of exceedance of the selected percentile
                    path: niger/poe-dryspell.zarr
                    var_names:
                        value: poe
                        lat: Y
                        lon: X
                        issue: S
                        lead: null
                        pct: P
                    colormap: pne_25
                    is_poe: yes
            vuln:
                colormap: vulnerability
                range: [0.0, 5.0]
        seasons:
            season1:
                label: JAS
                target_month: 7.5
                length: 3.0
                issue_months: [0, 1, 2, 3, 4, 5]
                start_year: 1991

    guatemala:
        logo: Guatemala_IRI_120x48.png
        resolution: [.1, .1]
        center: [-89, 16]
        zoom: 8
        rotation: 0
        marker:  [-90, 16]
        origin: [0, 0]
        shapes:
            - name: National
              sql: select adm0_code as key, adm0_name as label, ST_AsBinary(the_geom) as the_geom
                  from iridb.g2015_2012_0 where adm0_name = 'Guatemala'
              vuln_sql: select adm0_code as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Guatemala' group by 1, 2

            - name: Regional
              sql: select (adm0_code, adm1_code) as key, adm1_name as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.g2015_2014_1
                  where adm0_name = 'Guatemala'
              vuln_sql: select (adm0_code, adm1_code) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Guatemala' group by 1, 2

            - name: District
              sql: select (adm0_code, adm1_code, adm2_code) as key, adm2_name as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.g2015_2014_2
                  where adm0_name = 'Guatemala'
              vuln_sql: select (adm0_code, adm1_code, adm2_code) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Guatemala' group by 1, 2

        datasets:
            defaults:
                predictors:
                    - pnep
                    - rain
                predictand: bad-years
            observations:
                rain:
                    label: Rain
                    description: CHIRPS average precipitation over the season
                    path: rain-guatemala.zarr
                    var_names:
                        value: prcp_est
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                enso_state: *enso_ds
                bad-years:
                    label: Reported bad years
                    path: guatemala/bad-years.zarr
                    var_names:
                        value: bad
                        time: T
                    colormap: precip
                    lower_is_worse: no
                    format: bad
            forecasts:
                pnep:
                    label: Forecast prob non-exc
                    description: NextGen forecast probability of non-exceedance of selected percentile
                    path: pnep-guatemala.zarr
                    var_names:
                        value: pne
                        lat: Y
                        lon: X
                        issue: S
                        lead: null  # dataset has forecasts for only one season; L is implicit.
                        pct: P
                    colormap: pne_25
                    is_poe: no
            vuln:
                colormap: vulnerability
                range: [0.0, 5.0]
        seasons:
            season1:
                label: OND
                target_month: 10.5
                length: 3.0
                issue_months: [8]
                start_year: 1996

    djibouti:
        logo: Djibouti_IRI.svg
        resolution: [.25, .25]
        center: [43, 12]
        zoom: 8
        rotation: 0
        marker:  [43, 12]
        origin: [.125, 125]
        shapes:
            - name: National
              sql: select adm0_code as key, adm0_name as label, ST_AsBinary(the_geom) as the_geom
                  from iridb.g2015_2012_0 where adm0_name = 'Djibouti'
              vuln_sql: select adm0_code as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Djibouti' group by 1, 2

            - name: Regional
              sql: select code as key, INITCAP(district) as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.djibouti_adm01
              vuln_sql: select null as key, 0 as year, 0 as vuln
              # vuln_sql: select code as key, year, sum(vulnerability) as vuln
              #     from public.fbf_vulnerability where adm0_name = 'Djibouti' group by 1, 2

            - name: District
              sql: select adm2_pcode as key, adm2_en as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.djibouti_adm02
              vuln_sql: select null as key, 0 as year, 0 as vuln
              # vuln_sql: select adm2_pcode as key, year, sum(vulnerability) as vuln
              #     from public.fbf_vulnerability where adm0_name = 'Djibouti' group by 1, 2

        datasets:
            defaults:
                predictors:
                    - pnep
                    - rain
                predictand: bad-years
            observations:
                rain:
                    label: Rain
                    description: CHIRPS average precipitation over the season
                    path: djibouti/rain-jas.zarr
                    var_names:
                        value: prcp
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                ndvi:
                    label: NDVI
                    path: djibouti/ndvi-jas.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                enso_state: *enso_ds
                bad-years:
                    label: Reported bad years (lower is worse)
                    path: djibouti/bad-years.zarr
                    var_names:
                        value: bad
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
            forecasts:
                pnep:
                    label: Forecast prob non-exc
                    description: NextGen forecast probability of non-exceedance of selected percentile
                    path: djibouti/pnep-jas.zarr
                    var_names:
                        value: pne
                        lat: Y
                        lon: X
                        issue: S
                        lead: null  # dataset has forecasts for only one season; L is implicit.
                        pct: P
                    colormap: pne_25
                    is_poe: no
            vuln:
                colormap: vulnerability
                range: [0.0, 5.0]
        seasons:
            season1:
                label: JAS
                target_month: 7.5
                length: 3.0
                issue_months: [3, 4, 5]
                start_year: 1990

    djibouti-mam:
        logo: Djibouti_IRI.svg
        resolution: [.25, .25]
        center: [43, 12]
        zoom: 8
        rotation: 0
        marker:  [43, 12]
        origin: [.125, 125]
        shapes:
            - name: National
              sql: select adm0_code as key, adm0_name as label, ST_AsBinary(the_geom) as the_geom
                  from iridb.g2015_2012_0 where adm0_name = 'Djibouti'
              vuln_sql: select adm0_code as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Djibouti' group by 1, 2

            - name: Regional
              sql: select code as key, INITCAP(district) as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.djibouti_adm01
              vuln_sql: select null as key, 0 as year, 0 as vuln
              # vuln_sql: select code as key, year, sum(vulnerability) as vuln
              #     from public.fbf_vulnerability where adm0_name = 'Djibouti' group by 1, 2

            - name: District
              sql: select adm2_pcode as key, adm2_en as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.djibouti_adm02
              vuln_sql: select null as key, 0 as year, 0 as vuln
              # vuln_sql: select adm2_pcode as key, year, sum(vulnerability) as vuln
              #     from public.fbf_vulnerability where adm0_name = 'Djibouti' group by 1, 2

        datasets:
            defaults:
                predictors:
                    - pnep
                    - rain
                predictand: bad-years
            observations:
                rain:
                    label: Rain
                    description: CHIRPS average precipitation over the season
                    path: djibouti/rain-mam.zarr
                    var_names:
                        value: prcp
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                ndvi:
                    label: NDVI
                    path: djibouti/ndvi-mam.zarr
                    var_names:
                        value: NDVI
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number4
                enso_state: *enso_ds
                bad-years:
                    label: Reported bad years (lower is worse)
                    path: djibouti/bad-years-mam.zarr
                    var_names:
                        value: bad
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
            forecasts:
                pnep:
                    label: Forecast prob non-exc
                    description: NextGen forecast probability of non-exceedance of selected percentile
                    path: djibouti/pnep-mam.zarr
                    var_names:
                        value: pne
                        lat: Y
                        lon: X
                        issue: S
                        lead: null  # dataset has forecasts for only one season; L is implicit.
                        pct: P
                    colormap: pne_25
                    is_poe: no
            vuln:
                colormap: vulnerability
                range: [0.0, 5.0]
        seasons:
            season1:
                label: MAM
                target_month: 3.5
                length: 3.0
                issue_months: [1]
                start_year: 1991

    lesotho:
        logo: Lesotho_IRI_94x48.png
        resolution: [.0375, .0375]
        center: [28.25625, -29.606]
        zoom: 8
        rotation: 0
        marker:  [28.25625, -29.606]
        origin: [0, 0]
        shapes:
            - name: National
              sql: select adm0_code as key, adm0_name as label, ST_AsBinary(the_geom) as the_geom
                  from iridb.g2015_2012_0 where adm0_name = 'Lesotho'
              vuln_sql: select adm0_code as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Lesotho' group by 1, 2

            - name: District
              sql: select (adm0_code, adm1_code) as key, adm1_name as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.g2015_2014_1
                  where adm0_name = 'Lesotho'
              vuln_sql: select (adm0_code, adm1_code) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Lesotho' group by 1, 2

            - name: Council
              sql: select (adm0_code, adm1_code, adm2_code) as key, adm2_name as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.g2015_2014_2
                  where adm0_name = 'Lesotho'
              vuln_sql: select (adm0_code, adm1_code, adm2_code) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Lesotho' group by 1, 2

        datasets:
            defaults:
                predictors:
                    - pnep
                    - rain
                predictand: bad-years-ag
            observations:
                rain:
                    label: Rain
                    description: ENACTS average precipitation over the season
                    path: lesotho/enacts-precip-djf.zarr
                    var_names:
                        value: rfe
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                enso_state: *enso_ds
                bad-years-ag:
                    label: "Ag/food sec bad years"
                    description: Bad years for agriculture and food security sector
                    path: lesotho/bad-years.zarr
                    var_names:
                        value: Agriculture and Food Security
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                    units: rank
                bad-years-dma-rep:
                    label: DMA district rep bad years
                    description: Bad years according to DMA district representative
                    path: lesotho/bad-years.zarr
                    var_names:
                        value: "DMA district Representative"
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                    units: rank
                bad-years-dma-general:
                    label: DMA general bad years
                    description: DMA general bad years
                    path: lesotho/bad-years.zarr
                    var_names:
                        value: "DMA district Representative"
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                    units: rank
                bad-years-humanitarian:
                    label: Humanitarian org bad years
                    description: Bad years according to humanitarian organizations
                    path: lesotho/bad-years.zarr
                    var_names:
                        value: Humanitarian Organizations
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                    units: rank
                bad-years-natural-resources:
                    label: Natural resources bad years
                    description: Bad years for natural resources sector
                    path: lesotho/bad-years.zarr
                    var_names:
                        value: Natural Resources
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                    units: rank
                bad-years-nutrition:
                    label: Nutrition bad years
                    description: Bad years for nutrition sector
                    path: lesotho/bad-years.zarr
                    var_names:
                        value: Nutrition
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                    units: rank
            forecasts:
                pnep:
                    label: Forecast prob non-exc
                    description: NextGen forecast probability of non-exceedance of selected percentile
                    path: lesotho/pnep-djf.zarr
                    var_names:
                        value: pne
                        lat: Y
                        lon: X
                        issue: S
                        lead: null  # dataset has forecasts for only one season; L is implicit.
                        pct: P
                    colormap: pne_25
                    is_poe: no
            vuln:
                colormap: vulnerability
                range: [0.0, 5.0]
        seasons:
            season1:
                label: DJF
                target_month: 0.5
                length: 3.0
                issue_months: [8, 9, 10]
                start_year: 1983
    lesotho-ond:
        logo: Lesotho_IRI_94x48.png
        resolution: [.0375, .0375]
        center: [28.25625, -29.606]
        zoom: 8
        rotation: 0
        marker:  [28.25625, -29.606]
        origin: [0, 0]
        shapes:
            - name: National
              sql: select adm0_code as key, adm0_name as label, ST_AsBinary(the_geom) as the_geom
                  from iridb.g2015_2012_0 where adm0_name = 'Lesotho'
              vuln_sql: select adm0_code as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Lesotho' group by 1, 2

            - name: District
              sql: select (adm0_code, adm1_code) as key, adm1_name as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.g2015_2014_1
                  where adm0_name = 'Lesotho'
              vuln_sql: select (adm0_code, adm1_code) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Lesotho' group by 1, 2

            - name: Council
              sql: select (adm0_code, adm1_code, adm2_code) as key, adm2_name as label,
                  ST_AsBinary(the_geom) as the_geom from iridb.g2015_2014_2
                  where adm0_name = 'Lesotho'
              vuln_sql: select (adm0_code, adm1_code, adm2_code) as key, year, sum(vulnerability) as vuln
                  from public.fbf_vulnerability where adm0_name = 'Lesotho' group by 1, 2

        datasets:
            defaults:
                predictors:
                    - pnep
                    - rain
                predictand: bad-years-ag
            observations:
                rain:
                    label: Rain
                    description: ENACTS average precipitation over the season
                    path: lesotho/enacts-precip-ond.zarr
                    var_names:
                        value: rfe
                        lat: Y
                        lon: X
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                enso_state: *enso_ds
                bad-years-ag:
                    label: "Ag/food sec bad years"
                    description: Bad years for agriculture and food security sector
                    path: lesotho/bad-years-ond.zarr
                    var_names:
                        value: Agriculture and Food Security
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                    units: rank
                bad-years-dma-rep:
                    label: DMA district rep bad years
                    description: Bad years according to DMA district representative
                    path: lesotho/bad-years-ond.zarr
                    var_names:
                        value: "DMA district Representative"
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                    units: rank
                bad-years-dma-general:
                    label: DMA general bad years
                    description: DMA general bad years
                    path: lesotho/bad-years-ond.zarr
                    var_names:
                        value: "DMA district Representative"
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                    units: rank
                bad-years-humanitarian:
                    label: Humanitarian org bad years
                    description: Bad years according to humanitarian organizations
                    path: lesotho/bad-years-ond.zarr
                    var_names:
                        value: Humanitarian Organizations
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                    units: rank
                bad-years-natural-resources:
                    label: Natural resources bad years
                    description: Bad years for natural resources sector
                    path: lesotho/bad-years-ond.zarr
                    var_names:
                        value: Natural Resources
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                    units: rank
                bad-years-nutrition:
                    label: Nutrition bad years
                    description: Bad years for nutrition sector
                    path: lesotho/bad-years-ond.zarr
                    var_names:
                        value: Nutrition
                        time: T
                    colormap: precip
                    lower_is_worse: yes
                    format: number0
                    units: rank
            forecasts:
                pnep:
                    label: Forecast prob non-exc
                    description: NextGen forecast probability of non-exceedance of selected percentile
                    path: lesotho/pnep-ond.zarr
                    var_names:
                        value: pne
                        lat: Y
                        lon: X
                        issue: S
                        lead: null  # dataset has forecasts for only one season; L is implicit.
                        pct: P
                    colormap: pne_25
                    is_poe: no
            vuln:
                colormap: vulnerability
                range: [0.0, 5.0]
        seasons:
            season1:
                label: OND
                target_month: 10.5
                length: 3.0
                issue_months: [6, 7, 8]
                start_year: 1983
